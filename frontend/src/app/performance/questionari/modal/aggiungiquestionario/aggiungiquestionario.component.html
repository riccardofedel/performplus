<div class="modal-header">
  <h5 class="modal-title" id="exampleModalLabel">
    <span *ngIf="id !== undefined && tipoNodo == 'questionario'">{{
      "modifica questionario" | translate
    }}</span>
    <span *ngIf="idPadre !== undefined && tipoNodo == 'questionario'">{{
      "aggiungi questionario" | translate
    }}</span>
    <span *ngIf="id !== undefined && tipoNodo == 'ambito'">{{
      "modifica ambito" | translate
    }}</span>
    <span *ngIf="idPadre !== undefined && tipoNodo == 'ambito'">{{
      "aggiungi ambito" | translate
    }}</span>
    <span *ngIf="id !== undefined && tipoNodo == 'valore'">{{
      "modifica valore" | translate
    }}</span>
    <span *ngIf="idPadre !== undefined && tipoNodo == 'valore'">{{
      "aggiungi valore" | translate
    }}</span>
  </h5>
  <button
    type="button"
    class="close"
    (click)="activeModal.close()"
    aria-label="Close"
  >
    <span aria-hidden="true">&times;</span>
  </button>
</div>

<div class="modal-body">
  <span class="loading" *ngIf="loading">
    <div class="spinner-border" role="status">
      <span class="sr-only"></span>
    </div>
  </span>

  <div class="" *ngIf="!loading && creaForm">
    <form [formGroup]="creaForm" (ngSubmit)="onSubmit()">
      <div class="row">
        <div class="col-md-12 mb-3" *ngIf="tipoNodo != 'questionario'">
          <label for="codice">{{ "codice" | translate }} *</label>
          {{ codiceCompleto }}
          <input
            id="codice"
            type="text"
            class="form-control form-control-border"
            formControlName="codice"
            placeholder="{{ 'codice' | translate }}"
            [ngClass]="{ 'is-invalid': f.codice.errors }"
          />
        </div>

        <div class="col-md-12 mb-3">
          <label for="intestazione">{{ "intestazione" | translate }} *</label>
          <input
            id="intestazione"
            class="form-control form-control-border"
            type="text"
            formControlName="intestazione"
            placeholder="{{ 'intestazione' | translate }}"
            [ngClass]="{ 'is-invalid': f.intestazione.errors }"
          />
        </div>
        <div class="col-md-12 mb-3" *ngIf="tipoNodo == 'questionario'">
          <label class="form-control-placeholder-select" for="categorie"
            >{{ "categorie" | translate }} *</label
          >

          <ng-select
            [ngClass]="{ 'is-invalid': !f.categorie.value }"
            id="categorie"
            [items]="categorie"
            [searchable]="false"
            [multiple]="true"
            [clearable]="false"
            bindLabel="descrizione"
            bindValue="id"
            formControlName="categorie"
            placeholder=" "
          >
            <ng-template ng-option-tmp let-item="item">
              <label>{{ item.descrizione }}</label>
            </ng-template>
            <ng-template ng-label-tmp let-item="item">
              <span>{{ item.descrizione }}</span>
            </ng-template>
          </ng-select>
        </div>

        <div class="col-md-12 mb-3" *ngIf="tipoNodo == 'questionario'">
          <label class="form-control-placeholder-select" for="incarichi"
            >{{ "incarichi" | translate }} *</label
          >

          <ng-select
            [ngClass]="{ 'is-invalid': !f.incarichi.value }"
            id="incarichi"
            [items]="incarichi"
            [searchable]="false"
            [multiple]="true"
            [clearable]="false"
            bindLabel="descrizione"
            bindValue="id"
            formControlName="incarichi"
            placeholder=" "
          >
            <ng-template ng-option-tmp let-item="item">
              <label>{{ item.descrizione }}</label>
            </ng-template>
            <ng-template ng-label-tmp let-item="item">
              <span>{{ item.descrizione }}</span>
            </ng-template>
          </ng-select>
        </div>

        <div class="col-md-12 mb-3">
          <label for="descrizione">{{ "descrizione" | translate }}</label>
          <textarea
            id="descrizione"
            class="form-control form-control-border"
            type="text"
            formControlName="descrizione"
            placeholder="{{ 'descrizione' | translate }}"
            [ngClass]="{ 'is-invalid': f.descrizione.errors }"
          ></textarea>
        </div>

        <div class="col-md-12 mb-3" *ngIf="tipoNodo != 'questionario'">
          <label for="peso">{{ "peso" | translate }}</label>
          <input
            id="peso"
            class="form-control form-control-border"
            type="number"
            formControlName="peso"
            placeholder="{{ 'peso percentuale' | translate }}"
            [ngClass]="{ 'is-invalid': f.peso.errors }"
          />
        </div>

        <div class="col-md-12 mb-3" *ngIf="tipoNodo == 'ambito'">
          <label class="custom-control-label" for="foglia">{{
            "foglia" | translate
          }}</label>
          <div class="form-check form-switch">
            <input
              id="foglia"
              class="form-check-input"
              formControlName="foglia"
              type="checkbox"
            />
          </div>
        </div>
        <div class="col-md-12 mb-3" *ngIf="tipoNodo == 'ambito'">
          <label for="pesoMancataAssegnazione">{{
            "pesoMancataAssegnazione " | translate
          }}</label>
          <input
            id="pesoMancataAssegnazione"
            class="form-control form-control-border"
            type="number"
            formControlName="pesoMancataAssegnazione"
            placeholder="{{ 'pesoMancataAssegnazione' | translate }}"
          />
        </div>
        <div class="col-md-12 mb-3" *ngIf="tipoNodo == 'ambito'">
          <label for="pesoMancatoColloquio">{{
            "pesoMancatoColloquio " | translate
          }}</label>
          <input
            id="pesoMancatoColloquio"
            class="form-control form-control-border"
            type="number"
            formControlName="pesoMancatoColloquio"
            placeholder="{{ 'pesoMancatoColloquio' | translate }}"
          />
        </div>
        <div class="col-md-12 mb-3" *ngIf="tipoNodo == 'ambito'">
          <label class="custom-control-label" for="flagSoloAdmin">{{
            "flagSoloAdmin" | translate
          }}</label>

          <div class="form-check form-switch">
            <input
              id="flagSoloAdmin"
              class="form-check-input"
              type="checkbox"
              formControlName="flagSoloAdmin"
            />
          </div>
        </div>
        <div class="col-md-12 mb-3 text-right">
          <a
            (click)="activeModal.close()"
            type="button"
            class="btn btn-secondary"
            >{{ "annulla" | translate }}</a
          >&nbsp;
          <button [disabled]="creaForm.invalid" class="btn btn-primary">
            {{ "salva" | translate }}
          </button>
        </div>
      </div>
    </form>
  </div>
</div>
