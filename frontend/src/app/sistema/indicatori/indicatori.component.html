<div class="content">
  <div class="breadcrumb"><a [routerLink]="['/home']">{{'home'|translate}}</a> - <a
      [routerLink]="['/sistema']">{{'sistema'|translate}}</a></div>
  <div class="title">{{'indicatori'|translate}}</div>

  <sistemabar page="indicatori"></sistemabar>
  <div class="p-3" *ngIf="!loading && !permissionService.getPermission(currentUser,Permission.Sistema,true)">
    {{"no permesso"|translate}}
    </div>

  <div class="maincnt" *ngIf="permissionService.getPermission(currentUser,Permission.Sistema,true)">
    <div>

      <span *ngIf="loading">
        <div class="loader">
          <div class="spinner-border" role="status">
            <span class="visually-hidden">Loading...</span>
          </div>
        </div>
      </span>


      <div class="row">
        <div class="col-md-4">
          <form [formGroup]="cercaForm" (ngSubmit)="onSubmit()" *ngIf="!loading && cercaForm">
            <div class="input-group mb-3">
              <input id="cerca" class="form-control" type="text" formControlName="cerca" placeholder="{{'Cerca'}}"
                [ngClass]="{ 'is-invalid': f.cerca.errors }">
              <button class="btn btn-primary">
                <i-bs name="search" width="1.5rem" height="1.5rem"></i-bs>
              </button>
            </div>
          </form>
        </div>
        <div class="col-md-8 text-end">
          <a *ngIf="writeAllowed()"  [routerLink]="['/sistema/indicatori/crea']" class="btn btn-primary px-4">
            <i-bs name="plus" width="1.5rem" height="1.5rem"></i-bs>{{'nuovo indicatore'|translate}}
          </a>
        </div>
      </div>

      <div class="table-responsive">
      <table class="table align-middle table-big" *ngIf="!loading">
        <thead>
          <tr>
            <th scope="col"></th>
            <th scope="col">{{"denominazione"|translate}}</th>
            <th scope="col">{{"formula"|translate}}</th>
            <th scope="col">{{"raggruppamento"|translate}}</th>
            <th scope="col">{{"percentuale"|translate}}</th>
            <th scope="col"></th>
          </tr>
        </thead>
        <tbody>
          <tr *ngFor="let indicatore of indicatori; let i=index" [ngClass]="{'oddRow': (i%2)}">
            <th scope="row">#{{ indicatore.id }}</th>
            <th scope="row">{{ indicatore.denominazione }}</th>
            <td>
              {{ indicatore.formula }}
            </td>
            <td>
              {{ indicatore.raggruppamento }}
            </td>
            <td>
              <i-bs *ngIf="indicatore.percentuale" name="check" width="1.5rem" height="1.5rem"></i-bs>

            </td>
            <td class="text-end">
              <a *ngIf="writeAllowed()" [routerLink]="['/sistema/indicatori/dettaglio/'+indicatore.id]"
                class="btn btn-free">
                <i-bs name="pen" width="1.5rem" height="1.5rem"></i-bs>
              </a>
              &nbsp;
              <a *ngIf="writeAllowed()" (click)="elimina(indicatore.id)" class="btn btn-free">
                <i-bs name="trash" width="1.5rem" height="1.5rem"></i-bs>
              </a>

            </td>
          </tr>
        </tbody>
      </table>
      </div>

      <div class="d-flex justify-content-between p-2">
      </div>

      <pagination *ngIf="!loading" [paginationService]="paginationService" class="flex-shrink-1"></pagination>
    </div>
  </div>
</div>
<!--content-->
